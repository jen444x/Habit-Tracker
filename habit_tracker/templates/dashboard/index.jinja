{% extends 'base.jinja' %}

{% block header %}
{# layout #}
  <h1>{% block title %}Due Today{% endblock %}</h1>
{% endblock %}

{% block content %}
  {# Challenge filter tabs #}
  {% if all_challenges %}
  <div class="flex gap-2 mb-4 overflow-x-auto pb-1">
    <a
      href="{{ url_for('dashboard.index') }}"
      class="px-3 py-1 text-sm font-medium rounded-full whitespace-nowrap transition-colors duration-150
        {% if not challenge_filter %}
          bg-calm-500 text-white
        {% else %}
          bg-gray-100 text-gray-500 hover:bg-gray-200
        {% endif %}"
    >All</a>
    {% for c in all_challenges %}
      <a
        href="{{ url_for('dashboard.index', challenge=c['id']) }}"
        class="px-3 py-1 text-sm font-medium rounded-full whitespace-nowrap transition-colors duration-150
          {% if challenge_filter == c['id'] %}
            bg-calm-500 text-white
          {% else %}
            bg-gray-100 text-gray-500 hover:bg-gray-200
          {% endif %}"
      >{{ c['title'] }}</a>
    {% endfor %}
  </div>
  {% endif %}

  {# New habit button #}
  <a
    href="{{ url_for('dashboard.create') }}"
    class="block text-center bg-calm-600 hover:bg-calm-500 text-white py-2 rounded-lg font-bold cursor-pointer text-xl shadow-lg/30 transition-colors duration-150 mb-6"
  >
    + New Habit
  </a>

  {# habits #}
  <div class="flex flex-col gap-4">
    {% for habit in habits %}
      {# Each habit  #}
      <div class="bg-white hover:bg-gray-50 cursor-pointer rounded-xl px-4 py-3 shadow-lg/30 border-2 border-calm-500 transition-all duration-150">
        <div class="flex flex-row items-center">
          <a
          class="habit basis-6/7 flex gap-6"
          href="{{ url_for('dashboard.update', id=habit['id']) }}"
          >
              <h3
                class="font-black text-xl font-bold text-calm-600">
                {{habit['title'] }}
              </h3>
              <p
                class="text-lg text-gray-500 font-sans font-light truncate">
                {{ habit['body'] }}
              </p>
          </a>
          <form
          action="{{ url_for('dashboard.complete', id=habit['id']) }}"
          method="post"
          class="basis-1/7"
          >
            <button
                class="text-white text-xl bg-calm-500 hover:bg-calm-600 rounded-xl cursor-pointer px-4 py-1.5 shadow-lg/30 transition-colors duration-150">
              &#10004
            </button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>

  {% if habits_done %}
    <hr class="my-8 border-t border-gray-300">

    <div class="flex flex-col gap-4">
      {# List of habits done #}
      {% for habit in habits_done %}
        {# Each habit   #}
        <div class="bg-gray-50 hover:bg-white cursor-pointer rounded-xl px-4 py-3 border-2 border-gray-300 transition-all duration-150">
          <div class="flex flex-row items-center">
            <a
            class="habit basis-6/7 flex gap-6"
            href="{{ url_for('dashboard.update', id=habit['id']) }}"
            >
              <h3
                class="font-black text-xl font-bold text-gray-400 line-through">
                {{habit['title'] }}
              </h3>
              <p
                class="text-lg text-gray-400 font-sans font-light truncate">
                {{ habit['body'] }}
              </p>
            </a>
            <form
            action="{{ url_for('dashboard.undo_complete', id=habit['id']) }}"
            method="post"
            class="basis-1/7"
            >
              <button
                  class="text-calm-600 text-sm bg-white hover:bg-calm-50 rounded-xl cursor-pointer px-3 py-1.5 border border-gray-300 transition-colors duration-150">
                Undo
              </button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endblock %}